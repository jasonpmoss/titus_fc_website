<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merch Store - TITUS Football Club</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Oswald:wght@500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        .merch-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .merch-item {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
            border: 1px solid #eee;
            transition: 0.3s;
        }

        .merch-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
            border-bottom: 4px solid var(--gold);
        }

        .price-tag {
            display: block;
            font-size: 1.5rem;
            color: var(--navy);
            font-family: 'Oswald', sans-serif;
            margin: 10px 0;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .order-summary {
            background: var(--navy);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }

        .total-display {
            font-size: 2rem;
            color: var(--gold);
            font-family: 'Oswald', sans-serif;
        }

        /* Hide success message initially */
        #success-message {
            display: none;
            text-align: center;
            padding: 40px;
        }
    </style>
</head>

<body>

    <nav>
        <div class="container nav-flex">
            <a href="index.html">
                <img src="logo.png" alt="Titus Logo" class="nav-logo">
            </a>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="register.html" class="btn-gold">Join Now</a></li>
            </ul>
        </div>
    </nav>

    <header class="section-light">
        <div class="container">
            <h1 class="text-navy">Club <span class="text-gold">Merchandise</span></h1>
            <p>Gear up for the season. Fill out the form below to place your order.</p>
        </div>
    </header>

    <section class="section-light" style="padding-top: 0;">
        <div class="container">

            <div id="success-message">
                <h2 class="text-navy">Order Received!</h2>
                <p>Thank you. Please proceed with payment using the details below.</p>
                <br>
                <a href="index.html" class="btn-gold">Back to Home</a>
            </div>

            <form id="merch-form" name="submit-to-google-sheet">

                <div style="background: white; padding: 25px; border-radius: 8px; margin-bottom: 30px;">
                    <h3 class="text-navy">1. Your Details</h3>
                    <div class="contact-flex" style="gap: 20px;">
                        <input type="text" name="Parent Name" placeholder="Parent Name" required class="form-control">
                        <input type="text" name="Phone" placeholder="Phone Number" required class="form-control">
                        <input type="email" name="Email" placeholder="Email Address" required class="form-control">
                    </div>
                </div>

                <h3 class="text-navy">2. Select Items</h3>
                <div class="merch-grid">

                    <div class="merch-item">
                        <i class="fa-solid fa-shirt fa-3x" style="color:var(--navy); margin-bottom:15px;"></i>
                        <h4>Official Tracksuit</h4>
                        <span class="price-tag">R660</span>
                        <select class="form-control item-select" data-name="Tracksuit" data-price="660">
                            <option value="0">Select Quantity</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                        </select>
                        <input type="text" class="form-control item-size" placeholder="Size (e.g., Age 10, S, M)">
                    </div>

                    <div class="merch-item">
                        <i class="fa-solid fa-futbol fa-3x" style="color:var(--red); margin-bottom:15px;"></i>
                        <h4>Official Match Kit</h4>
                        <span class="price-tag">R310</span>
                        <select class="form-control item-select" data-name="Match Kit" data-price="310">
                            <option value="0">Select Quantity</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                        </select>
                        <input type="text" class="form-control item-size" placeholder="Size (e.g., Age 12, M)">
                    </div>

                    <div class="merch-item">
                        <i class="fa-solid fa-users fa-3x" style="color:var(--gold); margin-bottom:15px;"></i>
                        <h4>Supporters Premium Jersey</h4>
                        <span class="price-tag">R460</span>
                        <select class="form-control item-select" data-name="Supporters Jersey" data-price="460">
                            <option value="0">Select Quantity</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                        <input type="text" class="form-control item-size" placeholder="Size (S, M, L, XL)">
                    </div>

                    <div class="merch-item">
                        <i class="fa-solid fa-bag-shopping fa-3x" style="color:#333; margin-bottom:15px;"></i>
                        <h4>Club Bag</h4>
                        <span class="price-tag">R300</span>
                        <select class="form-control item-select" data-name="Club Bag" data-price="300">
                            <option value="0">Select Quantity</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                    </div>

                    <div class="merch-item">
                        <i class="fa-solid fa-bottle-water fa-3x" style="color:#2980b9; margin-bottom:15px;"></i>
                        <h4>Water Bottle</h4>
                        <span class="price-tag">R180</span>
                        <select class="form-control item-select" data-name="Bottle" data-price="180">
                            <option value="0">Select Quantity</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                    </div>

                </div>

                <div class="order-summary">
                    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                        <div style="flex: 1; min-width: 300px;">
                            <h3 style="margin-bottom: 15px;">Payment Details</h3>
                            <p><strong>Bank:</strong> FNB </p>
                            <p><strong>Account Name:</strong> Titus Football Club</p>
                            <p><strong>Account Number:</strong> 63193435451</p>
                            <p><strong>Ref:</strong> Child's Name + Merch</p>
                        </div>
                        <div style="text-align: right; flex: 1; min-width: 300px;">
                            <h3>Total Estimated Cost</h3>
                            <div class="total-display">R<span id="grand-total">0</span></div>
                            <br>
                            <button type="submit" class="btn-gold-full" id="submit-btn" style="max-width: 300px;">PLACE
                                ORDER</button>
                        </div>
                    </div>
                </div>

                <input type="hidden" name="Items Ordered" id="hidden-items">
                <input type="hidden" name="Total Price" id="hidden-total">
                <input type="hidden" name="Status" value="New">

            </form>
        </div>
    </section>

    <footer>
        <div class="container">
            <p>&copy; 2026 Titus Football Club. All Rights Reserved.</p>
        </div>
    </footer>

    <script>
        // 1. CALCULATE TOTALS
        const selects = document.querySelectorAll('.item-select');
        const totalDisplay = document.getElementById('grand-total');
        const hiddenTotal = document.getElementById('hidden-total');
        const hiddenItems = document.getElementById('hidden-items');

        function updateTotals() {
            let total = 0;
            let itemsSummary = [];

            selects.forEach(select => {
                const qty = parseInt(select.value);
                if (qty > 0) {
                    const price = parseInt(select.dataset.price);
                    const name = select.dataset.name;

                    // Find the size input next to this select (if it exists)
                    const parentDiv = select.parentElement;
                    const sizeInput = parentDiv.querySelector('.item-size');
                    const size = sizeInput && sizeInput.value ? `(Size: ${sizeInput.value})` : '';

                    total += (qty * price);
                    itemsSummary.push(`${qty}x ${name} ${size}`);
                }
            });

            totalDisplay.innerText = total;
            hiddenTotal.value = "R" + total;
            hiddenItems.value = itemsSummary.join(", ");
        }

        // Add event listeners to update total whenever user changes qty or types size
        selects.forEach(s => s.addEventListener('change', updateTotals));
        document.querySelectorAll('.item-size').forEach(i => i.addEventListener('input', updateTotals));

        // 2. SUBMIT TO GOOGLE SHEETS
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxVUvWRDUD9SU6GbhRa7dfopzfoyCwK9_uqDiqDD5A1JklMlhQ4bXdg-NCaE7FDlFCkmQ/exec'; // <--- PASTE URL HERE
        const form = document.forms['submit-to-google-sheet'];
        const btn = document.getElementById('submit-btn');

        form.addEventListener('submit', e => {
            e.preventDefault();
            btn.disabled = true;
            btn.innerText = "Processing...";

            updateTotals(); // Ensure latest values are captured

            fetch(scriptURL, { method: 'POST', body: new FormData(form) })
                .then(response => {
                    document.getElementById('merch-form').style.display = 'none';
                    document.getElementById('success-message').style.display = 'block';
                    window.scrollTo(0, 0);
                })
                .catch(error => {
                    console.error('Error!', error.message);
                    alert("Something went wrong. Please try again.");
                    btn.disabled = false;
                    btn.innerText = "PLACE ORDER";
                });
        });
    </script>

</body>

</html>